.PHONY: up down logs build clean test

# ì „ì²´ ì‹œì‘
up:
	docker-compose up -d
	@echo "âœ… ì„œë²„ ì‹œì‘ ì™„ë£Œ!"
	@echo "ğŸŒ Nginx: http://localhost"
	@echo "ğŸ”Œ API: http://localhost:8080"
	@echo "ğŸ’¾ DB: localhost:5432"

# ì¤‘ì§€
down:
	docker-compose down

# ë¡œê·¸ ë³´ê¸°
logs:
	docker-compose logs -f

# ë¹Œë“œ
build:
	docker-compose build

# ì™„ì „ ì‚­ì œ (DB ë°ì´í„° í¬í•¨)
clean:
	docker-compose down -v

# ì—°ê²° í…ŒìŠ¤íŠ¸
test:
	@echo "ğŸ§ª ì—°ê²° í…ŒìŠ¤íŠ¸..."
	@echo "\n1ï¸âƒ£ Nginx í…ŒìŠ¤íŠ¸:"
	@curl -s http://localhost || echo "âŒ Nginx ì—°ê²° ì‹¤íŒ¨"
	@echo "\n2ï¸âƒ£ API ì§ì ‘ í…ŒìŠ¤íŠ¸:"
	@curl -s http://localhost:8080/api/test || echo "âŒ API ì—°ê²° ì‹¤íŒ¨"
	@echo "\n3ï¸âƒ£ Nginx â†’ API í…ŒìŠ¤íŠ¸:"
	@curl -s http://localhost/api/test || echo "âŒ Nginx â†’ API ì—°ê²° ì‹¤íŒ¨"
	@echo "\n4ï¸âƒ£ í—¬ìŠ¤ì²´í¬:"
	@curl -s http://localhost/health || echo "âŒ í—¬ìŠ¤ì²´í¬ ì‹¤íŒ¨"
	@echo "\nâœ… í…ŒìŠ¤íŠ¸ ì™„ë£Œ!"

# ì¬ì‹œì‘
restart: down up
